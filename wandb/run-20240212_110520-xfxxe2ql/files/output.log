GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:604: UserWarning: Checkpoint directory output_testing/xfxxe2ql exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
  | Name  | Type                  | Params
------------------------------------------------
0 | model | CausalNormalizingFlow | 2.6 K
------------------------------------------------
2.6 K     Trainable params
0         Non-trainable params
2.6 K     Total params
0.011     Total estimated model params size (MB)
/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 8 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 8 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py:1595: PossibleUserWarning: The number of training batches (5) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
  rank_zero_warn(
[94m[INFO] Experiment folder: output_testing/xfxxe2ql
[96m[DEBUG] Setting lr: 0.001
Epoch 5:  33%|â–Ž| 2/6 [00:00<00:00, 24.17it/s, loss=6.950, v_num=0, log_prob=-6.95, time_forward=0.564, loss_jacobian_x=0.000, loss_jacobian_u=0.000, log_prob_true=-7.14
`Trainer.fit` stopped: `max_epochs=10` reached.
Restoring states from the checkpoint path at /Users/georgivitanov/Desktop/Thesis/causal-flows/output_testing/xfxxe2ql/last.ckpt
Loaded model weights from checkpoint at /Users/georgivitanov/Desktop/Thesis/causal-flows/output_testing/xfxxe2ql/last.ckpt
/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:488: PossibleUserWarning: Your `test_dataloader`'s sampler has shuffling enabled, it is strongly recommended that you turn shuffling off for val/test/predict dataloaders.
  rank_zero_warn(
/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, test_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 8 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
Epoch 9: 100%|â–ˆ| 6/6 [00:00<00:00, 42.70it/s, loss=8.890, v_num=0, log_prob=-8.89, time_forward=0.609, loss_jacobian_x=0.000, loss_jacobian_u=0.000, log_prob_true=-7.14
[94m[INFO] Testing train split
Testing DataLoader 0:   0%|                                                                                                                       | 0/5 [00:00<?, ?it/s]> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(138)predict()
-> delta_times.append(self.compute_time(tic, n))
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(150)predict()
-> if self.plot:
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(137)predict()
-> pdb.set_trace()
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(150)predict()
-> if self.plot:
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(137)predict()
-> pdb.set_trace()
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(150)predict()
-> if self.plot:
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(137)predict()
-> pdb.set_trace()
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(150)predict()
-> if self.plot:
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(137)predict()
-> pdb.set_trace()
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(150)predict()
-> if self.plot:
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(137)predict()
-> pdb.set_trace()
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(150)predict()
-> if self.plot:
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(137)predict()
-> pdb.set_trace()
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(150)predict()
-> if self.plot:
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(137)predict()
-> pdb.set_trace()
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(150)predict()
-> if self.plot:
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(137)predict()
-> pdb.set_trace()
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(150)predict()
-> if self.plot:
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(137)predict()
-> pdb.set_trace()
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(150)predict()
-> if self.plot:
> /Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py(137)predict()
-> pdb.set_trace()
Traceback (most recent call last):
  File "main.py", line 150, in <module>
    _ = trainer.test(ckpt_path=ckpt_name, dataloaders=loader_i)
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1098, in _run
    results = self._run_stage()
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "/Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py", line 383, in test_step
    loss_dict = self.predict(
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py", line 137, in predict
    pdb.set_trace()
  File "/Users/georgivitanov/Desktop/Thesis/causal-flows/causal_nf/models/causal_nf.py", line 137, in predict
    pdb.set_trace()
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/Users/georgivitanov/opt/anaconda3/envs/cnf/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit